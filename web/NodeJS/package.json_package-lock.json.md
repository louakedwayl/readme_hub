# ğŸ“¦ Cours sur `package.json` et `package-lock.json`

## ğŸ§  Introduction

Dans un projet **Node.js**, deux fichiers jouent un rÃ´le central dans la gestion des dÃ©pendances :

- **`package.json`** : dÃ©crit le projet, ses dÃ©pendances et ses scripts.
- **`package-lock.json`** : enregistre la version exacte des dÃ©pendances installÃ©es pour assurer la reproductibilitÃ©.

---

## 1. `package.json` â€” Le cÅ“ur du projet

### ğŸ” DÃ©finition

Le fichier `package.json` contient les **mÃ©tadonnÃ©es** dâ€™un projet Node.js.  
Câ€™est un peu lâ€™Ã©quivalent dâ€™un "fichier de configuration" qui dÃ©crit :

- le **nom** et la **version** du projet,
- les **scripts** que lâ€™on peut exÃ©cuter,
- les **dÃ©pendances** et leurs versions,
- les **informations** sur lâ€™auteur, la licence, etc.

### ğŸ§© Exemple basique

```json
{
  "name": "mon-projet",
  "version": "1.0.0",
  "description": "Un exemple de projet Node.js",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "jest"
  },
  "keywords": ["node", "npm", "cours"],
  "author": "Jane Doe",
  "license": "MIT",
  "dependencies": {
    "express": "^4.18.2"
  },
  "devDependencies": {
    "jest": "^29.7.0"
  }
}
```

---

## 2. Les champs importants du `package.json`

| Champ | Description |
|-------|--------------|
| `name` | Nom du projet ou du package. |
| `version` | Version du projet selon [semver](https://semver.org/lang/fr/). |
| `description` | BrÃ¨ve description du projet. |
| `main` | Point dâ€™entrÃ©e principal du projet (fichier exÃ©cutÃ© par `require()`). |
| `scripts` | Commandes personnalisÃ©es exÃ©cutables via `npm run <script>`. |
| `dependencies` | Liste des dÃ©pendances nÃ©cessaires Ã  lâ€™exÃ©cution du projet. |
| `devDependencies` | DÃ©pendances utilisÃ©es uniquement en dÃ©veloppement (tests, buildâ€¦). |
| `keywords` | Mots-clÃ©s pour rÃ©fÃ©rencer le package sur npm. |
| `license` | Type de licence du projet. |

---

## 3. Les versions et la notation semver

Le systÃ¨me de versionnement **SemVer (Semantic Versioning)** suit la convention suivante :

```
MAJEURE.MINEURE.PATCH
```

Exemple : `^4.18.2`

| Symbole | Signification | Exemple |
|----------|----------------|----------|
| `^` | Accepte les mises Ã  jour mineures et correctives | `^1.2.3` â†’ 1.2.4, 1.3.0, mais pas 2.0.0 |
| `~` | Accepte uniquement les corrections (patches) | `~1.2.3` â†’ 1.2.4, mais pas 1.3.0 |
| `>` / `<` | SpÃ©cifie des bornes prÃ©cises | `>1.0.0`, `<2.0.0` |
| Aucun symbole | Version exacte obligatoire | `1.2.3` uniquement |

---

## 4. `package-lock.json` â€” La photographie des dÃ©pendances

### ğŸ”’ DÃ©finition

Le fichier **`package-lock.json`** est gÃ©nÃ©rÃ© automatiquement par npm lors de lâ€™installation (`npm install`).

Il contient :
- la **version exacte** de chaque dÃ©pendance installÃ©e (y compris celles des dÃ©pendances des dÃ©pendances),
- les **adresses de tÃ©lÃ©chargement** (URL du registre npm),
- les **checksums** pour garantir lâ€™intÃ©gritÃ© des fichiers.

### ğŸ¯ Objectif

Assurer que **tous les dÃ©veloppeurs du projet** (ou environnements de production) utilisent **exactement les mÃªmes versions** de dÃ©pendances.

---

## 5. DiffÃ©rences clÃ©s entre `package.json` et `package-lock.json`

| Aspect | `package.json` | `package-lock.json` |
|--------|----------------|---------------------|
| RÃ´le | DÃ©crit les dÃ©pendances **dÃ©clarÃ©es** | Enregistre les dÃ©pendances **installÃ©es** |
| LisibilitÃ© | Ã‰ditÃ© manuellement | GÃ©nÃ©rÃ© automatiquement |
| Version | Peut contenir des plages de versions (`^`, `~`, etc.) | Contient des versions figÃ©es |
| NÃ©cessitÃ© | Obligatoire dans tout projet Node.js | GÃ©nÃ©rÃ© automatiquement, mais **Ã  versionner** |
| But | Fournir une vue gÃ©nÃ©rale du projet | Garantir la reproductibilitÃ© des installations |

---

## 6. ğŸ› ï¸ Commandes npm utiles

| Commande | Description |
|-----------|--------------|
| `npm init` | CrÃ©e un fichier `package.json` interactif. |
| `npm install` | Installe les dÃ©pendances du projet et crÃ©e/maj le `package-lock.json`. |
| `npm install <package>` | Ajoute une dÃ©pendance et la met dans `dependencies`. |
| `npm install --save-dev <package>` | Ajoute une dÃ©pendance de dÃ©veloppement. |
| `npm ci` | Installe **exactement** les versions du `package-lock.json` (plus rapide et fiable pour CI/CD). |
| `npm update` | Met Ã  jour les packages selon les rÃ¨gles du `package.json`. |

---

## 7. ğŸ§ª Exemple de workflow typique

1. **Initialisation du projet**  
   ```bash
   npm init -y
   ```
2. **Installation dâ€™une dÃ©pendance**  
   ```bash
   npm install express
   ```
   â†’ Met Ã  jour `package.json` et crÃ©e `package-lock.json`.
3. **ExÃ©cution dâ€™un script**  
   ```bash
   npm run start
   ```
4. **Ajout dâ€™une dÃ©pendance de dev**  
   ```bash
   npm install --save-dev jest
   ```

---

## 8. ğŸš¨ Bonnes pratiques

âœ… Toujours **committer le `package-lock.json`** dans votre dÃ©pÃ´t.  
âœ… Ne pas modifier le `package-lock.json` manuellement.  
âœ… Utiliser `npm ci` dans les environnements CI/CD.  
âœ… Garder vos dÃ©pendances Ã  jour rÃ©guliÃ¨rement.  
âœ… VÃ©rifier les vulnÃ©rabilitÃ©s avec :
```bash
npm audit
```

---

## ğŸ“š Conclusion

- **`package.json`** : la **dÃ©claration** de votre projet.  
- **`package-lock.json`** : la **rÃ©alitÃ© exacte** de vos dÃ©pendances installÃ©es.  

Les deux sont complÃ©mentaires et essentiels pour garantir la cohÃ©rence, la portabilitÃ© et la stabilitÃ© dâ€™un projet Node.js.
